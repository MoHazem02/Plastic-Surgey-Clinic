<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <!-- Bootstrap 3.3.2 -->
  <link href="../static/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />    
  <!-- FontAwesome 4.3.0 -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <!-- Ionicons 2.0.0 -->
  <link href="http://code.ionicframework.com/ionicons/2.0.0/css/ionicons.min.css" rel="stylesheet" type="text/css" />    
  <!-- Theme style -->
  <link href="../static/dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />
  <!-- AdminLTE Skins. Choose a skin from the css/skins 
       folder instead of downloading all of them to reduce the load. -->
  <link href="../static/dist/css/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="skin-blue">
  <div class="wrapper">
    <!-- Header and sidebar code here -->
    <header class="main-header">
      <a href="#" class="logo">
        <b>Admin Dashboard</b>
      </a>
      <nav class="navbar navbar-static-top" role="navigation">
        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <li class="dropdown user user-menu">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <img src="../static/dist/img/avatar.png" class="user-image" alt="User Image"/>
                <span class="hidden-xs">Admin User</span>
              </a>
              <ul class="dropdown-menu">
                <li class="user-header">
                  <img src="../static/dist/img/avatar.png" class="img-circle" alt="User Image"/>
                  <p>
                    Admin User
                    <small>Member since Jan. 2024</small>
                  </p>
                </li>
                <li class="user-footer">
                  <div class="pull-right">
                    <a href="#" class="btn btn-default btn-flat">Sign out</a>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <aside class="main-sidebar">
      <section class="sidebar">
        <ul class="sidebar-menu">
          <li class="header">MAIN NAVIGATION</li>
          <li class="active"><a href="#"><i class="fa fa-circle-o"></i> Home</a></li>
          <li><a href="#"><i class="fa fa-bar-chart"></i> View Analytics</a></li>
          <li><a href="#"><i class="fa fa-trash"></i> Delete Users</a></li>
          <li><a href="#"><i class="fa fa-calendar"></i> Appointments</a></li>
        </ul>
      </section>
    </aside>
    <div class="content-wrapper">
      <section class="content-header">
        <h1>
          Admin Dashboard
          <small>Control panel</small>
        </h1>
      </section>
      <section class="content">
        <div class="row">
          <div class="col-lg-6 col-xs-6">
            <div class="small-box bg-green">
              <div class="inner">
                <h3>8</h3>
                <p>Appointments</p>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
              <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div>
          <div class="col-lg-6 col-xs-6">
            <div class="small-box bg-aqua">
              <div class="inner">
                <h3>4.5</h3>
                <p>Current Rating</p>
              </div>
              <div class="icon">
                <i class="ion ion-pie-graph"></i>
              </div>
              <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div>
        </div>
        <div class="row">
          <section class="col-lg-7 connectedSortable">
            <div class="box box-success">
              <div class="box-header">
                <i class="fa fa-comments-o"></i>
                <h3 class="box-title">Chat</h3>
                <div class="box-tools pull-right" data-toggle="tooltip" title="Status">
                  <div class="btn-group" data-toggle="btn-toggle" >
                    <button type="button" class="btn btn-default btn-sm active"><i class="fa fa-circle text-green"></i></button>
                    <button type="button" class="btn btn-default btn-sm"><i class="fa fa-circle text-red"></i></button>
                  </div>
                </div>
              </div>
              <div class="box-body chat" id="chat-box">
                <div class="item">
                  <img src="../static/dist/img/user2-160x160.jpg" alt="user image" class="offline"/>
                  <p class="message">
                    <a href="#" class="name">
                      <small class="text-muted pull-right"><i class="fa fa-clock-o"></i> 5:15</small>
                      Doctor Smith
                    </a>
                    Hello! How can I help you today?
                  </p>
                </div>
              </div>
              <div class="box-footer">
                <div class="input-group">
                  <input class="form-control" placeholder="Type message..."/>
                  <div class="input-group-btn">
                    <button class="btn btn-success"><i class="fa fa-plus"></i></button>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <section class="col-lg-5 connectedSortable">
            <div class="box box-primary">
              <div class="box-header">
                <i class="ion ion-clipboard"></i>
                <h3 class="box-title">Appointments</h3>
                <div class="box-tools pull-right">
                  <ul class="pagination pagination-sm inline">
                    <li><a href="#">&laquo;</a></li>
                    <li><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">&raquo;</a></li>
                  </ul>
                </div>
              </div>
              <div class="box-body">
                <ul class="todo-list">
                  <li>
                    <span class="handle">
                      <i class="fa fa-ellipsis-v"></i>
                      <i class="fa fa-ellipsis-v"></i>
                    </span>
                    <input type="checkbox" value="" name=""/>
                    <a class="text" href="#">Appointment with Omar Emad on 2024-05-07 at 10:00</a>
                    <div class="tools">
                      <i class="fa fa-trash-o"></i>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </section>
        </div>
      </section>
    </div>
    <footer class="main-footer">
      <strong>Copyright &copy; 2024 <a>Cardio Tooth Care</a>.
      </strong> All rights reserved.
    </footer>
  </div>
  <!-- jQuery 2.1.3 -->
  <script src="../static/plugins/jQuery/jQuery-2.1.3.min.js"></script>
  <!-- Bootstrap 3.3.2 JS -->
  <script src="../static/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>    
</body>
</html>

</div><!-- ./wrapper -->
  <!-- AJAX request to fetch data -->
  <script>
    $(function () {
      // Handle view analytics click
      $('#viewAnalytics').click(function(e) {
        e.preventDefault();
        $('#analyticsSection').show();
        $('#deleteUsersSection').hide();
        $('#appointmentsSection').hide();
        fetchData();
      });

      // Handle delete users click
      $('#deleteUsers').click(function(e) {
        e.preventDefault();
        $('#deleteUsersSection').show();
        $('#analyticsSection').hide();
        $('#appointmentsSection').hide();
        fetchUsers();
      });

      // Handle appointments click
      $('#appointments').click(function(e) {
        e.preventDefault();
        $('#appointmentsSection').show();
        $('#deleteUsersSection').hide();
        $('#analyticsSection').hide();
        fetchAppointments();
      });

      // Handle form submission for deleting users
      $('#deleteUserForm').submit(function(e) {
        e.preventDefault();
        var userType = $('#userType').val();
        var userName = $('#userName').val();
        var userId = $('#userId').val();

        // Validate input fields
        if (!userType || !userName || !userId) {
          alert('Please fill in all fields');
          return;
        }

        // Make AJAX request to delete user
        deleteUser(userType, userName, userId);
      });

      function fetchData() {
        // Make an AJAX request to fetch analytics data
        // Replace '/your-backend-endpoint-url' with your actual backend endpoint URL
        $.ajax({
          url: '/your-backend-endpoint-url/analytics',
          type: 'GET',
          dataType: 'json',
          success: function (data) {
            renderCharts(data);
          },
          error: function (error) {
            console.error('Error fetching data:', error);
          }
        });
      }

      function renderCharts(data) {
        var ctx = document.getElementById('analyticsChart').getContext('2d');
        var analyticsChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
            datasets: [
              {
                label: 'Patients',
                data: data.patients,
                borderColor: 'blue',
                borderWidth: 2,
                fill: false
              },
              {
                label: 'Nurses',
                data: data.nurses,
                borderColor: 'green',
                borderWidth: 2,
                fill: false
              },
              {
                label: 'Doctors',
                data: data.doctors,
                borderColor: 'red',
                borderWidth: 2,
                fill: false
              },
              {
                label: 'Admins',
                data: data.admins,
                borderColor: 'orange',
                borderWidth: 2,
                fill: false
              }
            ]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      }

      function fetchUsers() {
        // Make an AJAX request to fetch users data
        // Replace '/your-backend-endpoint-url' with your actual backend endpoint URL
        $.ajax({
          url: '/your-backend-endpoint-url/users',
          type: 'GET',
          dataType: 'json',
          success: function (data) {
            renderUsers(data);
          },
          error: function (error) {
            console.error('Error fetching users:', error);
          }
        });
      }

      function renderUsers(data) {
        var userTableBody = $('#userTableBody');
        userTableBody.empty(); // Clear existing rows
        data.forEach(function(user) {
          var row = $('<tr>');
          row.append($('<td>').text(user.id));
          row.append($('<td>').text(user.name));
          row.append($('<td>').text(user.email));
          var actionBtn = $('<button>').text('Delete').addClass('btn btn-danger btn-sm');
          actionBtn.click(function() {
            deleteUser(user.id);
          });
          row.append($('<td>').append(actionBtn));
          userTableBody.append(row);
        });
      }

      function deleteUser(userType, userName, userId) {
        // Make an AJAX request to delete user
        // Replace '/your-backend-endpoint-url' with your actual backend endpoint URL
        $.ajax({
          url: '/your-backend-endpoint-url/users/delete',
          type: 'POST',
          data: {
            userType: userType,
            userName: userName,
            userId: userId
          },
          success: function (response) {
            // Reload users data after deletion
            fetchUsers();
            alert('User deleted successfully!');
          },
          error: function (error) {
            console.error('Error deleting user:', error);
            alert('Error deleting user. Please try again later.');
          }
        });
      }

      function fetchAppointments() {
        // Make an AJAX request to fetch appointments data
        // Replace '/your-backend-endpoint-url' with your actual backend endpoint URL
        $.ajax({
          url: '/your-backend-endpoint-url/appointments',
          type: 'GET',
          dataType: 'json',
          success: function (data) {
            renderAppointments(data);
          },
          error: function (error) {
            console.error('Error fetching appointments:', error);
          }
        });
      }

      function renderAppointments(data) {
        var appointmentTableBody = $('#appointmentTableBody');
        appointmentTableBody.empty(); // Clear existing rows
        data.forEach(function(appointment) {
          var row = $('<tr>');
          row.append($('<td>').text(appointment.id));
          row.append($('<td>').text(appointment.patientName));
          row.append($('<td>').text(appointment.doctorName));
          row.append($('<td>').text(appointment.date));
          row.append($('<td>').text(appointment.status));
          if (appointment.status === 'Cancelled') {
            var cancelBtn = $('<button>').text('Delete').addClass('btn btn-danger btn-sm');
            cancelBtn.click(function() {
              cancelAppointment(appointment.id);
            });
            row.append($('<td>').append(cancelBtn));
          } else {
            row.append($('<td>'));
          }
          appointmentTableBody.append(row);
        });
      }

      function cancelAppointment(appointmentId) {
        // Make an AJAX request to cancel appointment
        // Replace '/your-backend-endpoint-url' with your actual backend endpoint URL
        $.ajax({
          url: '/your-backend-endpoint-url/appointments/cancel',
          type: 'POST',
          data: {
            appointmentId: appointmentId
          },
          success: function (response) {
            // Reload appointments data after cancellation
            fetchAppointments();
            alert('Appointment cancelled successfully!');
          },
          error: function (error) {
            console.error('Error cancelling appointment:', error);
            alert('Error cancelling appointment. Please try again later.');
          }
        });
      }
    });
  </script>
</body>
</html>
